import numpy as np
import os
import sys
from astropy.io import ascii


# list of targets
names = ['CZTau', 'DPTau', 'FQTau', 'FSTau', 'FVTau', 'FXTau', 'GGTau', 
         'GHTau', 'GNTau', 'HLTau', 'Haro6-28', 'IRAS04260', 'IRAS04263',
         'IRAS04301', 'ITG40', 'J04202144', 'J04210795', 'J04231822',
         'J04333905', 'KPNO12', 'LR1', 'MHO3', 'RYTau', 'V410Xray2', 
         'XEST26-062', 'XZTau']

ra_c = [64.63162786625362, 70.65708182828782, 64.80352616268286, 
        65.5091354239521, 66.72308959934668, 67.62332089261605, 
        68.12651341096947, 68.27590876082053, 69.83725498319842,
        67.9101541666667, 68.98693874461458, 67.2707940812198,
        67.3402554267156, 68.30987746224699, 70.3526833333333,
        65.0893458333333, 65.28321530344869, 65.82605101647816, 
        68.41282112599453, 64.75533699347011, 64.6722166666667,
        63.6273185749781, 65.48924643785053, 64.6435291666667,
        73.98360897639743, 67.91702873667592] 

dec_c = [28.2828227209915, 25.26027575848813, 28.492450465350792,
         26.958425295413747, 26.1149841650471, 24.44581144643576,
         17.52783912652535, 24.159341225291524, 25.750444749858417,
         18.23268055555554, 22.909951788325596, 26.818582514814786,
         27.023757986588464, 26.23977712228343, 25.73139722222222,
         28.23032499999997, 27.038915302599605, 26.687583575565935,
         22.455681672508604, 28.046707217304707, 28.45694722222222,
         28.087284950653235, 28.44309318336528, 28.508397222222,
         30.605679874626354, 18.23240067751559]

names = ['J15430131', 'J15430227', 'J15450634', 'HNLup', 'J16011549',
         'J16070384', 'J16075475', 'J16080175', 'Sz102', 'J160831.1', 
         'J16085828', 'J16085834', 'J16091644', 'J16092032', 'J16092317',
         'J160934.2', 'J16093928', 'J16102741', 'J16120445']

ra_c = [235.7554833333, 235.759478253698, 236.27642916666667,
        237.02173123203156, 240.31454999999997, 241.76596229447992, 
        241.97812916666666, 242.0073291666667, 242.12383426467534,
        242.12958333333333, 242.2428625, 242.2431125, 
        242.31852916666665, 242.3347, 242.34654583333332, 
        242.39241666666666, 242.41370833333332, 242.6142375,
        243.01857925178248]

dec_c = [-34.15425, -34.73504725470962, -34.293841666666665, 
         -35.264804211901755, -41.876441666666665, -39.18657754126502,
         -39.2623972222222, -39.20879444444445, -39.05315929850272,
         -38.93333333333333, -39.12654166666667, -39.130325,
         -39.078836111111116, -39.06709166666667, -39.06874166666667,
         -39.25352777777778, -39.07546944444445, -39.04166111111,
         -38.166361316856616]

names = ['Sz4', 'J11062942', 'ISO91', 'VVCha', 'HKCha', 'VWCha', 'ESOHa-562', 
         'J11082570', 'GlassQ', 'ESOHa-569', 'ESOHa-574']

ra_c = [164.42542005360383, 166.62260833333332, 166.78855000000001, 
        166.8671197243853, 166.92643370348574, 167.00582256899153,
        167.01200784694313, 167.10710416666666, 167.6579205241828,
        167.7951375, 169.01151558854068]

dec_c = [-76.99323334434312, -77.4162888888889, -77.31309444444445,
         -76.87001173392946, -77.56649498687622, -77.70793869370792,
         -77.64515529165121, -77.27767222222222, -77.54440933293864,
         -76.69928611111112, -76.41478934894849]


for i in range(len(names)):

    data = ascii.read('data/'+names[i]+'_gaia.csv', format='csv',
                      fast_reader=True)
    dra  = (ra_c[i]-data['ra'])*np.cos(np.radians(dec_c[i]))
    ddec = (dec_c[i]-data['dec'])
    wgtd = 1./(dra**2+ddec**2)
    wgtp = 1./(data['parallax_error']**2)
    plx  = np.average(data['parallax'], weights=wgtd*wgtp)
    eplx = np.sqrt(np.average((data['parallax']-plx)**2, weights=wgtd*wgtp))
    print('%15s  %7.4f  %7.4f' % (names[i], plx, eplx) )
