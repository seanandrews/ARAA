import numpy as np
import os
import sys
from astropy.io import ascii


# list of targets
names = ['CZTau', 'DPTau', 'FQTau', 'FSTau', 'FVTau', 'FXTau', 'GGTau', 
         'GHTau', 'GNTau', 'HLTau', 'Haro6-28', 'IRAS04260', 'IRAS04263',
         'IRAS04301', 'ITG40', 'J04202144', 'J04210795', 'J04231822',
         'J04333905', 'KPNO12', 'LR1', 'MHO3', 'RYTau', 'V410Xray2', 
         'XEST26-062', 'XZTau']

ra_c = [64.63162786625362, 70.65708182828782, 64.80352616268286, 
        65.5091354239521, 66.72308959934668, 67.62332089261605, 
        68.12651341096947, 68.27590876082053, 69.83725498319842,
        67.9101541666667, 68.98693874461458, 67.2707940812198,
        67.3402554267156, 68.30987746224699, 70.3526833333333,
        65.0893458333333, 65.28321530344869, 65.82605101647816, 
        68.41282112599453, 64.75533699347011, 64.6722166666667,
        63.6273185749781, 65.48924643785053, 64.6435291666667,
        73.98360897639743, 67.91702873667592] 

dec_c = [28.2828227209915, 25.26027575848813, 28.492450465350792,
         26.958425295413747, 26.1149841650471, 24.44581144643576,
         17.52783912652535, 24.159341225291524, 25.750444749858417,
         18.23268055555554, 22.909951788325596, 26.818582514814786,
         27.023757986588464, 26.23977712228343, 25.73139722222222,
         28.23032499999997, 27.038915302599605, 26.687583575565935,
         22.455681672508604, 28.046707217304707, 28.45694722222222,
         28.087284950653235, 28.44309318336528, 28.508397222222,
         30.605679874626354, 18.23240067751559]


for i in range(len(names)):

    data = ascii.read('data/'+names[i]+'_gaia.csv', format='csv',
                      fast_reader=True)
    dra  = (ra_c[i]-data['ra'])*np.cos(np.radians(dec_c[i]))
    ddec = (dec_c[i]-data['dec'])
    wgtd = 1./(dra**2+ddec**2)
    wgtp = 1./(data['parallax_error']**2)
    plx  = np.average(data['parallax'], weights=wgtd*wgtp)
    eplx = np.sqrt(np.average((data['parallax']-plx)**2, weights=wgtd*wgtp))
    print('%15s  %7.4f  %7.4f' % (names[i], plx, eplx) )
